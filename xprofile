#
# ~/.xprofile
#

# env vars that only do anything if x is running
# TODO: check these are still relevant and maybe only load if necessary?
# gtk 4 apps using libadwaita need the dark theme to be forced for some reason,
# (even with a gtk 4 settings.ini :/)
export GTK_THEME=Adwaita:dark
# overlay scrollbars can fuck off (gtk 3 only, apparently :/)
export GTK_OVERLAY_SCROLLING=0
# set this so qt5 can be configured using qt5ct, since im not using a de qt5 can pull a theme from
# TODO: probably only do this if qt5ct is actually installed,
export QT_QPA_PLATFORMTHEME="qt5ct"

# afaik these are needed so fcitx will work in gtk and qt apps
if command -v fcitx5 > /dev/null 2>&1; then
    export GTK_IM_MODULE='fcitx'
    export QT_IM_MODULE='fcitx'
    export XMODIFIERS='@im=fcitx'
fi

# caps lock is useless, rebind it so i can use it to toggle direct input mode
# i have a bluetooth keyboard now and xmodmap doesn't work with hotplugged devices
# (https://bugs.freedesktop.org/show_bug.cgi?id=25262), so i've switched to xkb instead
# TODO: i feel like it'd probably be better to generate the keymap dynamically?
# shouldn't be that hard to just do it with sed...
test -f ~/.Xkeymap && xkbcomp ~/.Xkeymap $DISPLAY

# autorun:
# compositor
command -v xcompmgr > /dev/null 2>&1 && xcompmgr &

# ime
command -v fcitx5 > /dev/null 2>&1 && fcitx5 &

# app for hiding the mouse cursor when stationary
command -v unclutter > /dev/null 2>&1 && unclutter &

# color profile
# TODO: is there somewhere earlier i should be loading this?
command -v xiccd > /dev/null 2>&1 && xiccd &

# xsettingsd (currently only used for gtk hidpi config)
command -v xsettingsd > /dev/null 2>&1 && xsettingsd &

# blueman tray icon (for now. maybe i'll make a widget for this instead at some point)
command -v blueman-applet > /dev/null 2>&1 && blueman-applet &
